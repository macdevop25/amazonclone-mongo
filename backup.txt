https://images.surferseo.art/72e25adf-6e8f-4788-b287-8c589668ef96.jpeg



https://images.surferseo.art/37216291-8bac-4f7c-a7b8-d0c74cad8bdd.webp


    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const productTableBody = document.getElementById('productTableBody');
            const loadingSpinner = document.getElementById('loading');

            const fetchProducts = async () => {
                loadingSpinner.style.display = 'block';
                productTableBody.innerHTML = '';
                try {
                    const res = await fetch('/api/admin/products');
                    const data = await res.json();

                    if (res.ok) {
                        if (data.products.length > 0) {
                            data.products.forEach(product => {
                                const row = `
                                <tr>
  <td><img src="${product.image.startsWith('uploads') ? '/' + product.image : product.image}" alt="${product.title}" class="product-image rounded"></td>
  <td>${product.title}</td>
  <td>â‚¹${product.price.toFixed(2)}</td>
  <td>${product.category || 'N/A'}</td>
  <td>
    <button class="btn btn-sm btn-warning edit-btn" data-id="${product._id}">Edit</button>
    <button class="btn btn-sm btn-danger delete-btn" data-id="${product._id}">Delete</button>
  </td>
</tr>
     `;
     
                                productTableBody.insertAdjacentHTML('beforeend', row);
                            });
                        } else {
                            productTableBody.innerHTML = '<tr><td colspan="5" class="text-center">No products found.</td></tr>';
                        }
                    } else {
                        console.error('Failed to fetch products:', data.message);
                        productTableBody.innerHTML = `<tr><td colspan="5" class="text-center text-danger">Error: ${data.message}</td></tr>`;
                    }
                } catch (err) {
                    console.error('Fetch error:', err);
                    productTableBody.innerHTML = '<tr><td colspan="5" class="text-center text-danger">Failed to connect to the server.</td></tr>';
                } finally {
                    loadingSpinner.style.display = 'none';
                }
            };

            fetchProducts();

            // Add event listener for delete buttons
            productTableBody.addEventListener('click', async (e) => {
                const button = e.target;
                const productId = button.dataset.id;

                if (button.classList.contains('delete-btn')) {
                    if (confirm('Are you sure you want to delete this product?')) {
                        try {
                            const res = await fetch(`/api/admin/delete-product/${productId}`, {
                                method: 'DELETE'
                            });
                            const result = await res.json();
                            if (res.ok) {
                                alert(result.message);
                                fetchProducts(); // Reload products after deletion
                            } else {
                                alert(result.message || 'Failed to delete product.');
                            }
                        } catch (err) {
                            console.error('Delete error:', err);
                            alert('An error occurred while trying to delete the product.');
                        }
                    }
                }
            });
        });
        
    </script>